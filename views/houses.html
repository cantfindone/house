
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../../../favicon.ico">

    <title>蚂蚁筑家</title>

    <!-- Bootstrap core CSS -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/static/css/album.css" rel="stylesheet">
  </head>

  <body>

    <header>
      
      <nav class="navbar navbar-expand navbar-dark bg-dark">
		  <a class="navbar-brand" href="#">蚂蚁筑家</a>
		  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample02" aria-controls="navbarsExample02" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		  </button>

		  <div class="collapse navbar-collapse" id="navbarsExample02">
			<ul class="navbar-nav mr-auto">
			  <li class="nav-item">
				<a class="nav-link" href="/home">主页 </a>
			  </li>
			  <li class="nav-item">
				<a class="nav-link" href="/house/new">发布</a>
			  </li>
			</ul>
			<form class="form-inline my-2 my-md-0" method='get' onsubmit="search(this);" action='/house/search/_X_/0/0'>
			  <input class="form-control" type="text" name='q' value='{{q}}' placeholder="小区名搜索" >
			</form>
		  </div>
	  </nav>
    </header>

    <main role="main">
	<div class="album py-5 bg-light">
        <div class="container">

          <div class="row">
			{% for h in houses %}
            <div class="col-md-4">
              <div class="card mb-4 box-shadow">
				<div class="card-title">
				{{h.community}}
				</div>
                {% if h.photo%}
				<img  class="card-img-top" src="data:image/jpg;base64{{h.photo}}"/>
				{% else %}
                <img class="card-img-top" data-src="holder.js/50px110?theme=thumb&bg=55595c&fg=eceeef&text=暂无" alt="Card image cap">
                {% endif %}
                <div class="card-body">
                  <span class="card-text">{{h.room}}室{{h.hall}}厅</span>
				  <span class="card-text">{{h.size}}平</span>
				  <span class="card-text">{{h.floor}}楼</span>
				  <span class="card-text">{{h.price}}万元</span>
                  <div class="d-flex justify-content-between align-items-center">
                    <div class="float-right">
                      <a href='/house/house/{{h._id}}' class="btn btn-sm btn-outline-secondary">详情</a>
                      
                    </div>
					{% if h.favorite%}
					 <small class="text-muted" onclick="favor('{{h._id}}',this)">已收藏</small> 
					{% else %}
					 <small class="text-black" onclick="favor('{{h._id}}',this)">收藏</small> 
					{% endif %}
                    
                  </div>
                </div>
              </div>
            </div>
			{% endfor %}
          </div>		  
        </div>
      </div>
      

      
	<nav aria-label="Page navigation example">
	  <ul class="pagination justify-content-center">

		<li class="page-item disabled">
		  <a class="page-link" href="#" tabindex="-1"> 共{{page_total}}页</a>
		</li>
		<li class="page-item disabled"><span class='page-link'>第{{page_current}}页</span></li>
		<li class="page-item {% if page_current==1 %}disabled{% endif %}">
		  <a class="page-link" href="{{pre}}" tabindex="-1">上一页</a>
		</li>
		<!-- <li class="page-item"><a class="page-link" href="#">1</a></li> -->
		
		<!-- <li class="page-item"><a class="page-link" href="#">3</a></li> -->
		<li class="page-item {% if page_current==page_total %}disabled{% endif %}">
		  <a class="page-link" href="{{nex}}">下一页</a>
		</li>
	  </ul>
</nav>
    </main>
	<script>
	function favor(id, self){
	self=$(self);
	if(self.html()==='收藏'){
		$.post("/favorite",
		  {
			_id:id,
			favor:true
		  },
		  function(data,status){
			//alert("Data: " + data + "\nStatus: " + status);
			self.css('text-muted');
			self.html('已收藏');
		  });
		
	}else{
		$.post("/favorite",
		  {
			_id:id,
			favor:false
		  },
		  function(data,status){
			//alert("Data: " + data + "\nStatus: " + status);
			self.css('text-black');
			self.html('收藏')
		  });
		
	}
	};
	
	function search(self){
		
		var q=$(self).find('input').val();
		action=self.action;
		self.action=action.replace('_X_',q);
		return true;
	};
	
	</script>
    <footer class="footer">
      <div class="container">
        <span class="text-muted">蚂蚁筑家@2018</span>
      </div>
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" ></script>
    <script>window.jQuery || document.write('<script src="../../../../assets/js/vendor/jquery-slim.min.js"><\/script>')</script>
    <script src="/static/js/popper.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/holder.min.js"></script>
  </body>
</html>
